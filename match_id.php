<?php

// test whether we have a record base don id


// In cases where we may have duplicate references (e.g., one copy from CrossRef other from journal site)
// use approximate search to match them and merge

// Code will match on title within a year, if one has DOI and other doesn't, will merge
// by adding PDF to DOI rcord, then deleting PDF record.


require_once(dirname(__FILE__) . '/config.inc.php');
require_once(dirname(__FILE__) . '/adodb5/adodb.inc.php');


//----------------------------------------------------------------------------------------
$db = NewADOConnection('mysql');
$db->Connect("localhost", 
	$config['db_user'] , $config['db_passwd'] , $config['db_name']);

// Ensure fields are (only) indexed by column name
$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;

$db->EXECUTE("set names 'utf8'"); 


$ids = array(
'10.11646/phytotaxa.295.3.1',
'10.11646/phytotaxa.297.2.5',
'10.14258/turczaninowia.20.1.11',
'10.11646/phytotaxa.297.3.8',
'10.11646/phytotaxa.291.3.4',
'10.11646/phytotaxa.295.1.9',
'10.12705/661.6',
'10.11646/phytotaxa.295.2.5',
'10.12705/661.1',
'10.1371/journal.pone.0170107',
'10.1007/S12225-017-9681-X',
'10.11646/phytotaxa.291.2.8',
'10.11646/phytotaxa.297.2.2',
'10.7751/telopea11313',
'10.11646/phytotaxa.298.1.7',
'10.11646/phytotaxa.298.2.4',
'10.11646/phytotaxa.297.1.6',
'10.11646/phytotaxa.298.1.6',
'10.11646/phytotaxa.298.2.10',
'10.11646/phytotaxa.294.1.1',
'10.11646/phytotaxa.296.1.3',
'10.6165/tai.2017.62.24',
'10.11646/phytotaxa.297.1.12',
'10.3989/collectbot.2016.v35.008',
'10.3989/collectbot.2016.v35.006',
'10.3897/phytokeys.77.11727',
'10.3897/phytokeys.76.11220',
'10.1007/S12225-017-9694-5',
'10.11646/phytotaxa.291.1.1',
'10.11646/phytotaxa.295.1.3',
'10.7717/peerj.2835',
'10.11646/phytotaxa.291.3.6',
'10.11646/phytotaxa.292.1.3',
'10.11646/phytotaxa.292.3.5',
'10.3897/phytokeys.77.11345',
'10.11646/phytotaxa.296.3.7',
'10.11646/phytotaxa.295.1.6',
'10.11646/phytotaxa.296.2.6',
'10.7751/telopea11012',
'10.5852/ejt.2017.281',
'10.11646/phytotaxa.296.1.8',
'10.11646/phytotaxa.296.1.7',
'10.11646/phytotaxa.295.3.10',
'10.11646/phytotaxa.292.1.6',
'10.11646/phytotaxa.295.1.2',
'10.11646/phytotaxa.295.3.3',
'10.11646/phytotaxa.296.2.9',
'10.11646/phytotaxa.297.3.12',
'10.11646/phytotaxa.291.2.9',
'10.11646/phytotaxa.291.4.4',
'10.11646/phytotaxa.295.3.7',
'10.3897/phytokeys.76.10298',
'10.1139/cjb-2016-0048',
'10.11646/phytotaxa.295.2.3',
'10.11646/phytotaxa.297.1.13',
'10.1007/s12225-017-9684-7',
'10.11646/phytotaxa.295.3.8',
'10.11646/phytotaxa.291.2.10',
'10.11646/phytotaxa.297.3.3',
'10.11646/phytotaxa.292.2.6',
'10.11646/phytotaxa.298.2.11',
'10.11646/phytotaxa.297.2.9',
'10.11646/phytotaxa.297.1.7',
'10.3897/phytokeys.77.11575',
'10.3897/phytokeys.78.11923',
'10.11646/phytotaxa.297.1.9',
'10.1007/S12225-017-9682-9',
'10.1007/S12225-017-9680-Y',
'10.1007/S12225-017-9678-5',
'10.11646/phytotaxa.295.2.6',
'10.2985/015.089.0103',
'10.11646/phytotaxa.291.1.11',
'10.11646/phytotaxa.295.1.4',
'10.11646/phytotaxa.292.2.7',
'10.11646/phytotaxa.296.2.4',
'10.1007/S12225-017-9677-6',
'10.1002/fedr.201600008',
'10.11646/phytotaxa.292.3.10',
'10.7751/telopea11377',
'10.3897/phytokeys.77.11738',
'10.11646/phytotaxa.298.1.11',
'10.12705/661.3',
'10.11646/phytotaxa.297.3.1',
'10.11646/phytotaxa.291.1.3',
'10.11646/phytotaxa.296.1.6',
'10.3897/phytokeys.76.10921',
'10.11646/phytotaxa.295.3.4',
'10.11646/phytotaxa.297.2.10',
'10.11646/phytotaxa.291.1.9',
'10.11646/phytotaxa.295.3.11',
'10.11646/phytotaxa.291.1.8',
'10.3897/phytokeys.77.11190',
'10.3906/bot-1601-25',
'10.11646/phytotaxa.291.3.7',
'10.11646/phytotaxa.291.4.3',
'10.11646/phytotaxa.292.2.3',
'10.12705/661.7',
'10.11646/phytotaxa.296.1.2',
'10.11646/phytotaxa.292.3.8',
'10.11646/phytotaxa.295.2.8',
'10.11646/phytotaxa.296.1.9',
'10.11646/phytotaxa.297.3.10',
'10.11646/phytotaxa.296.3.11',
'10.11646/phytotaxa.291.2.4',
'10.11646/phytotaxa.298.2.9',
'10.1007/S12225-017-9688-3',
'10.11646/phytotaxa.292.1.5',
'10.7751/telopea10436',
'10.11646/phytotaxa.291.4.5',
'10.11646/phytotaxa.296.3.5',
'10.11646/phytotaxa.297.1.8',
'10.11646/phytotaxa.295.2.1',
'10.6165/tai.2017.62.1',
'10.11646/phytotaxa.295.3.2',
'10.11646/phytotaxa.298.1.8',
'10.1186/s40529-017-0164-z',
'10.11646/phytotaxa.291.2.7',
'10.11646/phytotaxa.292.1.7',
'10.7717/peerj.2893',
'10.11646/phytotaxa.291.2.6',
'10.11646/phytotaxa.291.4.7',
'10.11646/phytotaxa.295.2.7',
'10.11646/phytotaxa.292.1.8',
'10.11646/phytotaxa.296.1.4',
'10.5852/ejt.2017.284',
'10.11646/phytotaxa.295.3.6',
'10.3897/phytokeys.77.11513',
'10.11646/phytotaxa.298.1.10',
'10.3897/phytokeys.76.10808',
'10.11646/phytotaxa.296.3.6',
'10.11646/phytotaxa.298.1.9',
'10.12705/661.2',
'10.11646/phytotaxa.291.1.7',
'10.11646/phytotaxa.298.2.6',
'10.11646/phytotaxa.291.3.9',
'10.11646/phytotaxa.296.2.1',
'10.11646/phytotaxa.296.3.1',
'10.11646/phytotaxa.297.2.8',
'10.11646/phytotaxa.297.3.6',
'10.11646/phytotaxa.292.1.10',
'10.1556/034.59.2017.1-2.4',
'10.1556/034.59.2017.1-2.3',
'10.11646/phytotaxa.291.1.4',
'10.11646/phytotaxa.293.1.1',
'10.11646/phytotaxa.297.3.5',
'10.11646/phytotaxa.292.3.3',
'10.1007/S12225-017-9683-8',
'10.11646/phytotaxa.291.3.5',
'10.11646/phytotaxa.295.2.2',
'10.11646/phytotaxa.291.3.8',
'10.7751/telopea10452',
'10.6165/tai.2017.62.29',
'10.1007/S12225-017-9685-6',
'10.11646/phytotaxa.298.2.3',
'10.11646/phytotaxa.296.3.8',
'10.11646/phytotaxa.298.1.5',
'10.11646/phytotaxa.292.1.9',
'10.3897/phytokeys.76.11637',
'10.1007/S12225-017-9687-4',
'10.3906/bot-1603-11',
'10.11646/phytotaxa.299.1.6',
'10.3897/phytokeys.81.132203',
'10.11646/phytotaxa.306.3.7',
'10.1600/036364417X694575',
'10.1071/SB16050',
'10.11646/phytotaxa.311.2.2',
'10.5252/a2017n1a1',
'10.11646/phytotaxa.307.2.6',
'10.1080/00837792.2017.1311471',
'10.5852/ejt.2017.339',
'10.5735/085.054.0324',
'10.5091/plecevo.2017.1137',
'10.18942/apg.201611',
'10.1600/036364417X695484',
'10.1016/j.sajb.2017.04.002',
'10.1016/j.sajb.2017.03.021',
'10.11646/phytotaxa.298.3.3',
'10.11646/phytotaxa.299.2.6',
'10.3897/phytokeys.82.13010',
'10.12705/663.7',
'10.1080/00837792.2016.1258786',
'10.5735/085.054.0305',
'10.5735/085.054.0317',
'10.11646/phytotaxa.303.3.5',
'10.15553/c2017v722a4',
'10.1017/S0960428617000014',
'10.11646/phytotaxa.305.2.1',
'10.11646/phytotaxa.303.1.4',
'10.1600/036364417X694953',
'10.3850/S2010098116000093',
'10.3897/phytokeys.80.12872',
'10.5252/a2017n1a5',
'10.12705/662.8',
'10.11646/phytotaxa.311.1.2',
'10.1600/036364417X695448',
'10.11646/phytotaxa.299.1.15',
'10.15553/c2017v722a7',
'10.3897/phytokeys.81.11995',
'10.1016/j.bse.2017.04.001',
'10.1093/botlinnean/bow009',
'10.1093/botlinnean/bow013',
'10.11646/phytotaxa.302.3.7',
'10.11646/phytotaxa.306.2.6',
'10.11646/phytotaxa.303.1.1',
'10.11646/phytotaxa.299.2.13',
'10.11646/phytotaxa.308.2.10',
'10.11646/phytotaxa.305.3.1',
'10.11646/phytotaxa.305.4.1',
'10.1600/036364417X695493',
'10.11646/phytotaxa.305.1.7',
'10.11646/phytotaxa.298.3.7',
'10.11646/phytotaxa.302.2.10',
'10.11646/phytotaxa.308.2.9',
'10.1080/00837792.2017.1286773',
'10.1017/S0960428617000087',
'10.1017/S0960428617000075',
'10.1017/S0960428617000051',
'10.6165/tai.2017.62.105',
'10.3850/S2010098116000081',
'10.15553/c2017v722a3',
'10.11646/phytotaxa.307.1.1',
'10.1016/j.pld.2017.01.002',
'10.12705/663.4',
'10.1071/SB16031',
'10.14203/reinwardtia.v16i1.3001',
'10.11646/phytotaxa.302.2.11',
'10.3897/phytokeys.85.13930',
'10.15553/c2017v722a9',
'10.1071/SB16022',
'10.5735/085.054.0301',
'10.1093/botlinnean/box024',
'10.11646/phytotaxa.299.1.8',
'10.11646/phytotaxa.305.2.2',
'10.3897/phytokeys.82.12329',
'10.11646/phytotaxa.306.2.5',
'10.14258/turczaninowia.20.1.12',
'10.11646/phytotaxa.302.3.9',
'10.11646/phytotaxa.299.1.1',
'10.11646/phytotaxa.311.3.6',
'10.1093/botlinnean/box018',
'10.1080/00837792.2017.1309743',
'10.2985/015.089.0303',
'10.11646/phytotaxa.303.2.11',
'10.3372/wi.47.47101',
'10.11646/phytotaxa.303.1.6',
'10.11926/jtsb.3635',
'10.3897/phytokeys.81.13106',
'10.11646/phytotaxa.303.3.11',
'10.1093/botlinnean/bow016',
'10.11646/phytotaxa.303.2.8',
'10.11646/phytotaxa.305.3.3',
'10.12705/663.6',
'10.3159/TORREY-D-16-00013.1',
'10.11646/phytotaxa.311.1.7',
'10.1093/botlinnean/box029',
'10.3897/phytokeys.83.13490',
'10.3897/phytokeys.80.12232',
'10.11646/phytotaxa.308.1.7',
'10.11646/phytotaxa.303.1.8',
'10.11646/phytotaxa.308.1.14',
'10.11646/phytotaxa.306.2.7',
'10.11646/phytotaxa.302.3.12',
'10.11646/phytotaxa.305.1.8',
'10.12705/662.12',
'10.11646/phytotaxa.306.2.4',
'10.1093/botlinnean/box007',
'10.2985/015.089.0201',
'10.14258/turczaninowia.20.1.15',
'10.11646/phytotaxa.306.2.8',
'10.1600/036364417X694548',
'10.5735/085.054.0302',
'10.11646/phytotaxa.299.1.7',
'10.11646/phytotaxa.303.1.2',
'10.11646/phytotaxa.298.3.8',
'10.11646/phytotaxa.308.2.5',
'10.1600/036364417X694917',
'10.1600/036364417X694601',
'10.11646/phytotaxa.299.1.14',
'10.1007/s12224-016-9263-y',
'10.11646/phytotaxa.311.2.1',
'10.11646/phytotaxa.308.2.1',
'10.3417/2016024',
'10.14258/turczaninowia.19.1.10',
'10.5091/plecevo.2017.1305',
'10.1600/036364417X694584',
'10.1093/botlinnean/box021',
'10.1017/S096042861700004X',
'10.11646/phytotaxa.303.3.3',
'10.11646/phytotaxa.299.2.9',
'10.3158/2158-5520-17.10.1',
'10.11646/phytotaxa.306.1.5',
'10.11646/phytotaxa.307.1.10',
'10.1600/036364417X695600',
'10.15553/c2017v721a3',
'10.11646/phytotaxa.305.1.5',
'10.21474/IJAR01',
'10.11646/phytotaxa.308.1.11',
'10.18942/apg.201616',
'10.1093/botlinnean/box023',
'10.11646/phytotaxa.308.2.3',
'10.11646/phytotaxa.307.4.5',
'10.1600/036364417X695619',
'10.11646/phytotaxa.300.1.1',
'10.1093/botlinnean/box009',
'10.11646/phytotaxa.308.2.11',
'10.11646/phytotaxa.303.2.9',
'10.11931/guihaia.gxzw201511017',
'10.11646/phytotaxa.308.2.4',
'10.11646/phytotaxa.311.3.12',
'10.11646/phytotaxa.302.1.4',
'10.11646/phytotaxa.311.2.8',
'10.11646/phytotaxa.307.4.7',
'10.1017/S0960428617000129',
'10.5735/085.054.0314',
'10.1600/036364417X694962',
'10.11646/phytotaxa.308.1.9',
'10.11110/kjpt.2017.47.1.27',
'10.11646/phytotaxa.308.1.16',
'10.1080/23818107.2016.1263581',
'10.11646/phytotaxa.303.3.2',
'10.1016/j.sajb.2017.03.041',
'10.11646/phytotaxa.303.2.3',
'10.11646/phytotaxa.305.3.8',
'10.11646/phytotaxa.299.2.4',
'10.6165/tai.2017.62.121',
'10.6165/tai.2017.62.144',
'10.11646/phytotaxa.308.1.8',
'10.3897/phytokeys.83.12869',
'10.3897/phytokeys.81.13256',
'10.15553/c2017v722a8',
'10.11646/phytotaxa.303.3.9',
'10.11646/phytotaxa.299.2.1',
'10.12705/662.5',
'10.11646/phytotaxa.303.2.2',
'10.11646/phytotaxa.307.2.8',
'10.11646/phytotaxa.308.2.12',
'10.3897/phytokeys.80.13338',
'10.3850/S2010098116000046',
'10.11646/phytotaxa.302.2.8',
'10.11646/phytotaxa.307.2.9',
'10.11646/phytotaxa.305.3.5',
'10.1600/036364417X694593',
'10.11646/phytotaxa.305.2.3',
'10.11646/phytotaxa.307.3.5',
'10.11646/phytotaxa.307.1.9',
'10.6165/tai.2017.62.157',
'10.12705/663.5',
'10.3897/phytokeys.82.12914',
'10.11646/phytotaxa.305.2.5',
'10.11646/phytotaxa.307.1.3',
'10.14203/reinwardtia.v16i1.3111',
'10.15553/c2017v721a7',
'10.11646/phytotaxa.302.3.1',
'10.11646/phytotaxa.305.3.7',
'10.11646/phytotaxa.311.2.4',
'10.15553/c2017v722a5',
'10.1600/036364417X694629',
'10.14203/reinwardtia.v16i1.2744',
'10.6165/tai.2017.62.147',
'10.11646/phytotaxa.303.3.8',
'10.6165/tai.2017.62.116',
'10.11646/phytotaxa.307.1.5',
'10.11646/phytotaxa.307.4.1',
'10.11646/phytotaxa.298.3.11',
'10.11646/phytotaxa.308.2.7',
'10.11646/phytotaxa.303.2.12',
'10.3897/phytokeys.81.13488',
'10.15553/c2017v722a1',
'10.1600/036364417X695556',
'10.11646/phytotaxa.311.2.7',
'10.11110/kjpt.2017.47.2.100',
'10.11646/phytotaxa.303.3.12',
'10.11646/phytotaxa.303.3.7',
'10.6165/tai.2017.62.205',
'10.11646/phytotaxa.302.2.7',
'10.11646/phytotaxa.307.3.4',
'10.11646/phytotaxa.311.1.10',
'10.11646/phytotaxa.305.1.9',
'10.3897/phytokeys.82.13172',
'10.11646/phytotaxa.306.4.5',
'10.11646/phytotaxa.307.1.8',
'10.11646/phytotaxa.311.2.6',
'10.1080/23818107.2017.1315741',
'10.5735/085.054.0322',
'10.11646/phytotaxa.302.3.4',
'10.11646/phytotaxa.302.3.2',
'10.18942/apg.201613',
'10.3897/phytokeys.79.11215',
'10.11646/phytotaxa.311.3.2',
'10.14258/turczaninowia.19.2.4',
'10.1080/23818107.2017.1318091',
'10.15517/lank.v17i2.29933',
'10.11646/phytotaxa.302.3.5',
'10.15517/lank.v17i1.28526',
'10.1017/S0960428617000063',
'10.11646/phytotaxa.302.2.2',
'10.11646/phytotaxa.308.1.13',
'10.15517/lank.v17i1.28479',
'10.11646/phytotaxa.308.1.5',
'10.15517/lank.v17i1.28269',
'10.3417/2013032',
'10.11646/phytotaxa.311.3.3',
'10.1016/j.sajb.2017.03.018',
'10.11646/phytotaxa.305.3.2',
'10.5735/085.054.0313',
'10.11646/phytotaxa.307.2.7',
'10.20546/ijcrbp.2017.405.012',
'10.11646/phytotaxa.298.3.1',
'10.5735/085.054.0312',
'10.1080/00837792.2017.1287814',
'10.1093/botlinnean/bow006',
'10.11646/phytotaxa.302.1.11',
'10.11646/phytotaxa.307.4.2',
'10.3850/S2010098116000058',
'10.11646/phytotaxa.307.1.2',
'10.1600/036364417X694908',
'10.11646/phytotaxa.306.1.2',
'10.12705/663.11',
'10.12705/663.2',
'10.11646/phytotaxa.303.2.4',
'10.3897/phytokeys.83.12797',
'10.5735/085.054.0309',
'10.1600/036364417X694935',
'10.11646/phytotaxa.305.3.10',
'10.3850/S2010098116000104',
'10.1640/0002-8444-107.1.1',
'10.3897/phytokeys.82.13752',
'10.1600/036364417X695475',
'10.11646/phytotaxa.311.1.1',
'10.5735/085.054.0308',
'10.11646/phytotaxa.303.1.9',
'10.11646/phytotaxa.311.2.9',
'10.12705/663.3',
'10.11931/guihaia.gxzw201703042',
'10.11646/phytotaxa.307.3.1',
'10.1600/036364417X695529',
'10.5735/085.054.0321',
'10.5735/085.054.0306',
'10.5735/085.054.0316',
'10.15553/c2017v722a6',
'10.11110/kjpt.2017.47.1.23',
'10.11646/phytotaxa.308.2.8',
'10.11646/phytotaxa.302.1.10',
'10.15553/c2017v721a2',
'10.11646/phytotaxa.308.1.15',
'10.1600/036364417X695592',
'10.11646/phytotaxa.305.1.6',
'10.11646/phytotaxa.307.4.8',
'10.3897/phytokeys.80.13330',
'10.5252/a2017n1a4',
'10.6165/tai.2017.62.151',
'10.11646/phytotaxa.311.3.9',
'10.11646/phytotaxa.299.1.10',
'10.11646/phytotaxa.298.3.10',
'10.3897/phytokeys.83.13442',
'10.15553/c2017v722a11',
'10.1600/036364417X694926',
'10.15553/c2017v721a6',
'10.1600/036364417X695501',
'10.11646/phytotaxa.306.1.8',
'10.11646/phytotaxa.298.3.5',
'10.11646/phytotaxa.303.3.6',
'10.3897/phytokeys.80.12962',
'10.3372/wi.47.47112',
'10.5735/085.054.0318',
'10.1600/036364417X695574',
'10.1600/036364417X695583',
'10.11646/phytotaxa.305.1.3',
'10.5735/085.054.0319',
'10.3897/phytokeys.80.11126',
'10.12705/662.6',
'10.3897/phytokeys.85.12607',
'10.3897/phytokeys.82.12106',
'10.11646/phytotaxa.307.3.2',
'10.11110/kjpt.2017.47.2.95',
'10.7751/telopea11073',
'10.1071/SB16040',
'10.11646/phytotaxa.306.3.6',
'10.11931/guihaia.gxzw201605034',
'10.7525/j.issn.1673-5102.2017.03.001',
'10.11931/guihaia.gxzw201507006',
'10.11646/phytotaxa.299.1.11',
'10.3372/wi.47.47105',
'10.1080/00837792.2017.1308110',
'10.11646/phytotaxa.311.3.11',
'10.11646/phytotaxa.306.4.3',
'10.11646/phytotaxa.298.3.6',
'10.1017/S0960428617000117',
'10.1017/S0960428617000026'
);

$to_add = array();

foreach ($ids as $id)
{
	//  
	$sql = 'SELECT * FROM `publications` WHERE `guid` = "' . $id . '";';

	//$sql = 'SELECT * FROM `publications` WHERE `jstor` = "' . $id . '";';
	
	$result = $db->Execute($sql);
	if ($result == false) die("failed [" . __LINE__ . "]: " . $sql);
	
	if ($result->NumRows() == 0)
	{
		echo "*** Don't have $id ***\n";
		$to_add[] = '"' . $id . '"';
		//exit();
	}
	else
	{
		//echo "Found $id\n";
	}
}

echo '$dois=array(' . "\n";
print_r(join(",\n", $to_add));
echo ');' . "\n";
		


?>